

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CoDeepNEAT Specification &mdash; Tensorflow-Neuroevolution Framework 0.21.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CoDeepNEAT Configuration" href="codeepneat-config.html" />
    <link rel="prev" title="CoDeepNEAT Overview" href="codeepneat-overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Tensorflow-Neuroevolution Framework
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">TFNE Framework</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../framework/tfne-usage.html">Using TFNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../framework/tfne-customization.html">TFNE Architecture &amp; Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../framework/tfne-visualizer.html">TFNE Visualizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../framework/tfne-development.html">TFNE Development</a></li>
</ul>
<p class="caption"><span class="caption-text">CoDeepNEAT</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="codeepneat-overview.html">CoDeepNEAT Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CoDeepNEAT Specification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#codeepneat-encoding">CoDeepNEAT Encoding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#codeepneat-blueprint">CoDeepNEAT Blueprint</a></li>
<li class="toctree-l3"><a class="reference internal" href="#codeepneat-module">CoDeepNEAT Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#codeepneat-genome">CoDeepNEAT Genome</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#codeepneat-population">CoDeepNEAT Population</a></li>
<li class="toctree-l2"><a class="reference internal" href="#codeepneat-algorithm">CoDeepNEAT Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evaluation">Evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evolution">Evolution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="codeepneat-config.html">CoDeepNEAT Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="codeepneat-modules.html">CoDeepNEAT Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">TFNE Evaluation Environments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../environments/xor-environment.html">XOR Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/mnist-environment.html">MNIST Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/cifar10-environment.html">CIFAR10 Environment</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tensorflow-Neuroevolution Framework</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>CoDeepNEAT Specification</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/codeepneat/codeepneat-specification.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="codeepneat-specification">
<h1>CoDeepNEAT Specification<a class="headerlink" href="#codeepneat-specification" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This documentation solely lists the algorithm &amp; encoding specifications without concerning itself with the validity or potential of the specific choices that make up the CoDeepNEAT method.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This documentation outlines the CoDeepNEAT algorithm &amp; encoding specifications as understood by the TFNE project. While the TFNE project aims to stay as close as possible to the original specification, does it also aim to be a superset of the configuration options of the original specification. This specification also concretizes the algorithm specification if the original specification is too vague and no code was supplied. If you find an issue with the specification or the implementation details please contact <a class="reference external" href="mailto:tfne&#37;&#52;&#48;paulpauls&#46;de">tfne<span>&#64;</span>paulpauls<span>&#46;</span>de</a>. Thank you.</p>
</div>
<hr class="docutils" />
<div class="section" id="codeepneat-encoding">
<h2>CoDeepNEAT Encoding<a class="headerlink" href="#codeepneat-encoding" title="Permalink to this headline">¶</a></h2>
<p>The genotype of a CoDeepNEAT genome is made up of 2 essential parts. The first part is the CoDeepNEAT blueprint, specifying the ANN topology and the training hyperparameters that will be associated with the genome. The second part is a collection of small fully functional deep neural networks, termed the CoDeepNEAT modules, that will replace the nodes in the blueprint specified ANN topology. It is important to understand these two essential parts, what they entail, their exact contribution to the final genome and how exactly they are evolved in order to fully understand the CoDeepNEAT encoding and resulting genomes.</p>
<div class="section" id="codeepneat-blueprint">
<h3>CoDeepNEAT Blueprint<a class="headerlink" href="#codeepneat-blueprint" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 57%" />
<col style="width: 43%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Blueprint genotype</p></td>
<td><p>• Blueprint graph <br />
• Optimizer configuration</p></td>
</tr>
</tbody>
</table>
<p>A blueprint is the fundamental building block of a CoDeepNEAT genome, specifying the genome’s basic ANN topology as well as all its hyperparameters that may be associated with that genome.</p>
<p>In TFNE the current extent of hyperparameters saved by blueprints is a full configuration of a Tensorflow optimizer, specifying all variables required for the training of the genome phenotype TF model. Additional hyperparameters such as possible training preprocessing operations can also be included, though are currently not part of TFNE’s CoDeepNEAT. This Tensorflow optimizer configuration is the first part of the blueprint’s genotype.</p>
<p>The second part of the blueprint genotype is the graph that is specifying the basic ANN topology. This graph will be referred to as the blueprint graph. The blueprint graph is a collection of node and connection <em>gene</em> instances. In TFNE, those node and connection gene classes are defined as listed below, demonstrating the extent of the information they contain. The purpose and functionality of these blueprint graph genes is very similar to the functionality of genome genes in the original NEAT algorithm [see <a class="reference external" href="../neat/neat-overview.html">NEAT</a>], as they are adapted from those. The difference being that each node gene stores a module species and each connection gene merely indicates connections between nodes but not associated connection weights. As in NEAT is TFNE currently restricting the blueprint graph to representing a feedforward graph, though a later addition to support full recurrent graphs is planned.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CoDeepNEATBlueprintNode</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gene_id</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">species</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gene_id</span> <span class="o">=</span> <span class="n">gene_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">species</span>

<span class="k">class</span> <span class="nc">CoDeepNEATBlueprintConn</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gene_id</span><span class="p">,</span> <span class="n">conn_start</span><span class="p">,</span> <span class="n">conn_end</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gene_id</span> <span class="o">=</span> <span class="n">gene_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn_start</span> <span class="o">=</span> <span class="n">conn_start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn_end</span> <span class="o">=</span> <span class="n">conn_end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="n">enabled</span>

    <span class="k">def</span> <span class="nf">set_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="n">enabled</span>
</pre></div>
</div>
<p>Each gene is assigned an ID. This ID is not unique to each gene instance but unique to each configuration of (node, species) or (conn_start, conn_end) respectively. This behaviour is important to adhere to the principle of <em>Historical Markings</em> [see <a class="reference external" href="../neat/neat-overview.html">NEAT</a>]. The <code class="docutils literal notranslate"><span class="pre">node</span></code> value is graph-unique integer identifier for each node and is specified in <code class="docutils literal notranslate"><span class="pre">conn_start</span></code> and <code class="docutils literal notranslate"><span class="pre">conn_end</span></code> as the start- and endpoint of the connection. Each connection can be disabled through a mutation or crossover. The <code class="docutils literal notranslate"><span class="pre">species</span></code> value is the ID of an existing, non-extinct module species and is relevant for the later assembly of the final genome phenotype model, combining blueprint and modules.</p>
</div>
<div class="section" id="codeepneat-module">
<h3>CoDeepNEAT Module<a class="headerlink" href="#codeepneat-module" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 58%" />
<col style="width: 42%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Module genotype</p></td>
<td><p>• Merge method <br />
• Module DNN parameters</p></td>
</tr>
</tbody>
</table>
<p>A CoDeepNEAT module is a class of small deep neural networks that can take on only limited complexity. The ANN topology as well as the parameters of the ANN layers are determined through a uniform set of parameters serving as the module genotype. However, since the set of parameters for a module instance is uniform and bounded, does this prevent the topology to become overly complex as only limited information can be stored in a CoDeepNEAT module instance. On the other hand does this allow for a direct comparison of module parameters as each module instance stores values for each module parameter.</p>
<p>A CoDeepNEAT module is obviously a very general concept and its specifics are highly dependent on the concrete implementation. A simple example module is the pre-implemented <code class="docutils literal notranslate"><span class="pre">DenseDropout</span></code> module [see <a class="reference external" href="./codeepneat-modules.html">CoDeepNEAT Modules</a>], whose genotype storing has been implemented in TFNE as listed below. The module stores multiple parameters for the initial dense layer, a flag determining the presence of an optional subsequent dropout layer as well as parameters for that subsequent dropout layer. This simple class of module can only represent 2 possible ANN topologies, though it can potentially represent any valid parameter combination for the layer configuration.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CoDeepNEATModuleDenseDropout</span><span class="p">(</span><span class="n">CoDeepNEATModuleBase</span><span class="p">):</span>

    <span class="o">...</span>

    <span class="c1"># Register the module parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">merge_method</span> <span class="o">=</span> <span class="n">merge_method</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_init</span> <span class="o">=</span> <span class="n">kernel_init</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias_init</span> <span class="o">=</span> <span class="n">bias_init</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_flag</span> <span class="o">=</span> <span class="n">dropout_flag</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
</pre></div>
</div>
<p>The uniformity of module parameters mentioned above simplifies evolutionary operations such as speciation, mutation and crossover. More importantly however does the resulting limited complexity resemble the concept of CoDeepNEAT in that it aims to evolve effective small DNNs in a repetitive network topology quickly in order to exploit the same repetitive structure in the problem environment. These repetitive and deep structures are seen in many successful recent DNNs.</p>
<p>The module genotype also requires a specification of a specific merge method as well as a method for downsampling input for this module. Both methods become relevant when combining blueprint and modules in the genome assembly. As the creation of an appropriate downsampling layer can be very complex is this functionality coded into the module itself in TFNE and is therefore not part of the genotype.</p>
<p>The section <a class="reference external" href="./codeepneat-modules.html">CoDeepNEAT Modules</a> introduces multiple pre-implemented modules provided by TFNE.</p>
</div>
<div class="section" id="codeepneat-genome">
<h3>CoDeepNEAT Genome<a class="headerlink" href="#codeepneat-genome" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 43%" />
<col style="width: 57%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Genome genotype</p></td>
<td><p>• Blueprint <br />
• 1 Module for each Mod species present in BP <br />
• Output layers</p></td>
</tr>
</tbody>
</table>
<p>foobar</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="codeepneat-population">
<h2>CoDeepNEAT Population<a class="headerlink" href="#codeepneat-population" title="Permalink to this headline">¶</a></h2>
<p>foobar</p>
</div>
<hr class="docutils" />
<div class="section" id="codeepneat-algorithm">
<h2>CoDeepNEAT Algorithm<a class="headerlink" href="#codeepneat-algorithm" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Describe initialization, evaluation, evolution, etc in detail in their own
SubSubHeadings.</p></li>
<li><p>Go into detail about constraints and possible algorithmic details</p></li>
<li><p>Include short references to variables</p></li>
</ul>
<div class="section" id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<p><strong>[see CoDeepNEAT.initialize_population()]</strong></p>
<p>foobar</p>
</div>
<div class="section" id="evaluation">
<h3>Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this headline">¶</a></h3>
<p><strong>[see CoDeepNEAT.evaluate_population()]</strong></p>
<p>foobar</p>
</div>
<div class="section" id="evolution">
<h3>Evolution<a class="headerlink" href="#evolution" title="Permalink to this headline">¶</a></h3>
<p><strong>[see CoDeepNEAT.evolve_population()]</strong></p>
<p>foobar</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="codeepneat-config.html" class="btn btn-neutral float-right" title="CoDeepNEAT Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="codeepneat-overview.html" class="btn btn-neutral float-left" title="CoDeepNEAT Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Paul Pauls

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>